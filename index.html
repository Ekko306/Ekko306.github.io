<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: black; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="You are my JavaSript in my HTML.">
<meta property="og:type" content="website">
<meta property="og:title" content="SYPeng">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="SYPeng">
<meta property="og:description" content="You are my JavaSript in my HTML.">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SYPeng">
<meta name="twitter:description" content="You are my JavaSript in my HTML.">
  <link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>SYPeng</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">SYPeng</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

    

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <div id="posts" class="posts-expand">
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/26/Sharing-of-2020-s-Spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="望星的太阳花">
      <meta itemprop="description" content="You are my JavaSript in my HTML.">
      <meta itemprop="image" content="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1570163730249&di=dcd36b04d1066a90ddb1f132ae3a6bcc&imgtype=0&src=http%3A%2F%2Fhbimg.b0.upaiyun.com%2Ffe60497fd762440686b6d5702c2c9f19df71fb9911009-LVWEJj_fw658">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SYPeng">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/03/26/Sharing-of-2020-s-Spring/" class="post-title-link" itemprop="url">Sharing of 2020's Spring</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-03-26 11:22:52" itemprop="dateCreated datePublished" datetime="2020-03-26T11:22:52+08:00">2020-03-26</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-27 16:15:24" itemprop="dateModified" datetime="2020-03-27T16:15:24+08:00">2020-03-27</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Front-end/" itemprop="url" rel="index"><span itemprop="name">Front-end</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前端分享"><a href="#前端分享" class="headerlink" title="前端分享"></a>前端分享</h1><p>本次分享并不太正式，是把我前端学习过程中遇到的一些问题和新的用小本本记下来，想到什么分享什么，希望大家能喜欢，能了解一些前端的基础知识和一些很酷的东西。</p>
<h2 id="1-抓取音乐、MV的src，对象存储cos"><a href="#1-抓取音乐、MV的src，对象存储cos" class="headerlink" title="1. 抓取音乐、MV的src，对象存储cos"></a>1. 抓取音乐、MV的src，对象存储cos</h2><blockquote>
<p>用到一些tags中的src，想要引用自己的资源，有一些特别的方式（虽然以后经常是后端提供的服务器上的数据）</p>
</blockquote>
<h3 id="1-1-图片"><a href="#1-1-图片" class="headerlink" title="1.1 图片"></a>1.1 图片</h3><p>图片引入资源，最方便的方式是把需要的本地图片上传到自己的qq空间的相册里面，然后右键复制图片链接。</p>
<h3 id="1-2-音乐"><a href="#1-2-音乐" class="headerlink" title="1.2 音乐"></a>1.2 音乐</h3><h4 id="1-2-1-上传到对象存储（后端）"><a href="#1-2-1-上传到对象存储（后端）" class="headerlink" title="1.2.1 上传到对象存储（后端）"></a>1.2.1 上传到对象存储（后端）</h4><ol>
<li>这里需要注意是但凡是src引用的资源都是<strong>直链</strong>，直链资源是可以从地址名称后面看到需要的地址，并且可以直接作为下载链接下载下来。</li>
<li><strong>对象存储cos</strong>就是一种完成这种直接存储资源的云服务。</li>
</ol>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">❌（百度网盘）https://xact01.baidupcs.com/file/d00c83c210a43c672fcb1dbbae885178?bkt=en-cf7b18a7c51d9078138e5349f8e729ced6dbc2ade37a226cfe7de5aa430e0fe0390d768f7daa9935&amp;fid=1332307664-250528-1056090756407045&amp;time=1585216730&amp;sign=FDTAXGERLQlBHSKfW-DCb740ccc5511e5e8fedcff06b081203-V1hJzrKhbqBHznt5jeIlq1kpm1E%3D&amp;to=125&amp;size=4697782&amp;sta_dx=4697782&amp;sta_cs=1&amp;sta_ft=mp3&amp;sta_ct=7&amp;sta_mt=7&amp;fm2=MH%2CYangquan%2CAnywhere%2C%2Chubei%2Cct&amp;ctime=1535616269&amp;mtime=1535616269&amp;resv0=-1&amp;resv1=0&amp;resv2=rlim&amp;resv3=5&amp;resv4=4697782&amp;vuk=1332307664&amp;iv=0&amp;htype=&amp;randtype=&amp;newver=1&amp;newfm=1&amp;secfm=1&amp;flow_ver=3&amp;pkey=en-f14ccc04348d529105b59a5fa1f8d0b521b68520a82cced96be31028b10a4e0470a2aaab8f19184b&amp;sl=76480590&amp;expires=8h&amp;rt=pr&amp;r=616428251&amp;vbdid=3796106487&amp;fin=Axero-Trip.mp3&amp;fn=Axero-Trip.mp3&amp;rtype=1&amp;dp-logid=1988765693323297437&amp;dp-callid=0.1&amp;hps=1&amp;tsl=80&amp;csl=80&amp;fsl=-1&amp;csign=Dm5C8BgVJzST%2FVxbRwGdhi3mM10%3D&amp;so=0&amp;ut=6&amp;uter=4&amp;serv=0&amp;uc=3589459144&amp;ti=90e00819b6f54250900be0bd0f43baa82c67ad376e090cdc&amp;reqlabel=250528_f_ad8bcf02480b246b1f7b14b4585f9ec4_-1_a76f34a157f7e10b7e168b076b14195a&amp;by=themis</span><br><span class="line">❌（迅雷磁力链接）magnet:?xt=urn:btih:AE07A7A461010713CDB96BE944CDEC0A9FA549F6</span><br><span class="line">❌（迅雷链接）thunder://QUFmdHA6Ly9keTpkeUB4bGEueHVuYm8uY2M6MjAzMjcvW9G4wNfPwtTYd3d3Llh1bkJvLkNjXc3mvt/X3Lav1LExLkJEMTI4MLjfx+XW0NOiy6vX1i5ybXZiWlo=</span><br><span class="line">✅http://ossworkbench.muxixyz.com/1580392299.2325602.src.pdf</span><br></pre></td></tr></table></figure>

<ol>
<li>以上是我们平时用的<strong>普通下载链接</strong>，这些链接并不是直链，虽然打开地址可以下载下来资源，但不能用于src，因为他是一种下载地址，需要特定应用解析。</li>
<li>而<a href="http://work.muxixyz.com/project/6/file/58" target="_blank" rel="noopener">工作台</a>里面的文件上传的地址是<strong>直链</strong><br>可以看到最后是直接用pdf这种文件格式结尾的，可以直接用于html标签。</li>
</ol>
<hr>
<p><strong>使用对象存储服务cos(七牛云/腾讯云cos)</strong><br>使用租用的云存储服务上传自己想要的资源。<br><a href="https://cloud.tencent.com/product/cos" target="_blank" rel="noopener">腾讯云cos</a></p>
<ol>
<li>确定收费模式（按量/按时间）</li>
<li>上传资源</li>
<li>设置安全权限（公共获取/私有获取）</li>
</ol>
<p>P.S.:还有很多这种能够上传使用网络地址资源的方式，比如linux系统上搭建web服务器比如tomcat或者docker（老板推荐的部署web应用方法），现在不会，大家可以学学一起分享。</p>
<h4 id="1-2-2-获取网易云音乐及酷我音乐的src"><a href="#1-2-2-获取网易云音乐及酷我音乐的src" class="headerlink" title="1.2.2 获取网易云音乐及酷我音乐的src"></a>1.2.2 获取网易云音乐及酷我音乐的src</h4><blockquote>
<p>不自己上传也可以用特别的方法获取网上已经有的<strong>直链资源</strong></p>
</blockquote>
<ol>
<li><a href="https://music.163.com/#/song?id=1312017438" target="_blank" rel="noopener">网易云音乐</a>的<strong>非VIP</strong>资源全在以下链接中<br><code>http://music.163.com/song/media/outer/url?id=[id].mp3</code><br>需要将id换成自己想要的网易云音乐的地址上的id。VIP资源行不通。</li>
<li><a href="http://www.kuwo.cn/play_detail/23540977" target="_blank" rel="noopener">酷我音乐</a>很不科学，直接在控制台network的media中复制就能获取😂。</li>
<li>以上都是网上找到的方法（很菜花了好大功夫才找到，可以用于一些参加比赛啥的又没有后端引用资源的快捷方法，也可以自用下载一些想要的资源，很酷。）</li>
</ol>
<h3 id="1-3-视频"><a href="#1-3-视频" class="headerlink" title="1.3 视频"></a>1.3 视频</h3><p>没有特别方便获取网上视频直链的方法，这里提供两种奇葩方法下载视频（想引用成直链上传到对象存储）</p>
<ol>
<li><a href="https://yunyinyue.iiilab.com/" target="_blank" rel="noopener">https://yunyinyue.iiilab.com/</a><br>输入网易云<a href="https://music.163.com/#/video?id=F8C289FD3AA02EAE91198EB9D399886A" target="_blank" rel="noopener">mv</a>的地址，帮你解析出来地址，也可以用于html的src，也可以供你下载，但是发现，过一段时间这个服务器地址上的文件会消失，最好还是存到自己的服务器上。</li>
<li>命令行下载神器：<a href="https://github.com/soimort/you-get#supported-sites" target="_blank" rel="noopener">you-get</a><br>有了命令行可以比普通用户用鼠标点来点去更方便的使用一些终端带有的工具。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">exe //windows最方便</span><br><span class="line">pip3 install you-get //命令行安装you-get工具</span><br><span class="line"></span><br><span class="line">//显示目标资源的格式(清晰度)</span><br><span class="line">you-get -i https://www.bilibili.com/video/BV18W411j7Rf?from=search&amp;seid=15059123380627704164  </span><br><span class="line">//下载指定清晰度的视频</span><br><span class="line">you-get --format=mp4hd https://www.bilibili.com/video/BV18W411j7Rf?from=search&amp;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="2-正则表达式-与-JavaScript里的正则表达式-与-WebStorm"><a href="#2-正则表达式-与-JavaScript里的正则表达式-与-WebStorm" class="headerlink" title="2. 正则表达式 与 JavaScript里的正则表达式 与 WebStorm"></a>2. 正则表达式 与 JavaScript里的正则表达式 与 WebStorm</h2><blockquote>
<p><strong>正则表达式</strong>是一种学起来有点复杂，但是当你熟练理解掌握后威力无穷的工具。还可以网络爬虫啥的。</p>
</blockquote>
<p>很多语言都有正则表达式，要掌握某一种语言正则表达式的用法。</p>
<ol>
<li><p>string.match() ⭐️</p>
</li>
<li><p>string.search()</p>
</li>
<li><p>string.replace()</p>
</li>
<li><p>string.split()</p>
</li>
<li><p>regExp.test()</p>
</li>
<li><p>regExp.exec()  ⭐️</p>
</li>
<li><p>regExp.complie()</p>
</li>
</ol>
<p><strong>/\r?\n/</strong></p>
<h2 id="3-简单部署react打包项目（最基础可用）"><a href="#3-简单部署react打包项目（最基础可用）" class="headerlink" title="3. 简单部署react打包项目（最基础可用）"></a>3. 简单部署react打包项目（最基础可用）</h2><h3 id="3-1-打包项目"><a href="#3-1-打包项目" class="headerlink" title="3.1 打包项目"></a>3.1 打包项目</h3><ol>
<li><p>json:<code>&quot;homepage&quot;: &quot;./&quot;</code></p>
</li>
<li><p>npm run build</p>
<h3 id="3-2-上传项目"><a href="#3-2-上传项目" class="headerlink" title="3.2 上传项目"></a>3.2 上传项目</h3></li>
<li><p>scp命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scp /home/work/source.txt work@192.168.0.10:/home/work/   #把本地的source.txt文件拷贝到192.168.0.10机器上的/home/work目录下</span><br><span class="line"></span><br><span class="line">scp work@192.168.0.10:/home/work/source.txt /home/work/   #把192.168.0.10机器上的source.txt文件拷贝到本地的/home/work目录下</span><br><span class="line"></span><br><span class="line">scp work@192.168.0.10:/home/work/source.txt work@192.168.0.11:/home/work/   #把192.168.0.10机器上的source.txt文件拷贝到192.168.0.11机器的/home/work目录下</span><br><span class="line"></span><br><span class="line">scp -r /home/work/sourcedir work@192.168.0.10:/home/work/   #拷贝文件夹，加-r参数</span><br><span class="line"></span><br><span class="line">scp -P 1362 -r work@192.168.0.10:/public/home/abc /Users/abc/ #指定服务器端口-P以及文件夹</span><br></pre></td></tr></table></figure>
</li>
<li><p>sftp协议上传（搭建麻烦，使用方便）</p>
<h3 id="3-3-环境搭建"><a href="#3-3-环境搭建" class="headerlink" title="3.3 环境搭建"></a>3.3 环境搭建</h3><p><a href="https://www.html.cn/qa/react/14488.html" target="_blank" rel="noopener">https://www.html.cn/qa/react/14488.html</a><br>尽量用yum指令安装<br>java-&gt;tomcat-&gt;nodejs-&gt;create-react-app</p>
</li>
</ol>
<h3 id="3-4-部署项目"><a href="#3-4-部署项目" class="headerlink" title="3.4 部署项目"></a>3.4 部署项目</h3><ol>
<li>serve -s build （so easy）</li>
<li>ctrl+z 隐藏到后台<br>(1) CTRL+Z挂起进程并放入后台<br>(2) jobs 显示当前暂停的进程<br>(3) bg %N 使第N个任务在后台运行(%前有空格)<br>(4) fg %N 使第N个任务在前台运行<br>默认bg,fg不带%N时表示对最后一个进程操作!</li>
<li>有安全组的服务器打开端口5000</li>
<li>浏览器输入ip地址+端口号 成功进入。</li>
</ol>
<h3 id="3-5-关闭项目"><a href="#3-5-关闭项目" class="headerlink" title="3.5 关闭项目"></a>3.5 关闭项目</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lsof -i:5000 #查看5000端口的进程的PID</span><br><span class="line">kill -s 9 [PID] #杀死指定PID进程</span><br></pre></td></tr></table></figure>

<h2 id="4-文档在线预览的方法"><a href="#4-文档在线预览的方法" class="headerlink" title="4. 文档在线预览的方法"></a>4. 文档在线预览的方法</h2><h3 id="4-1-微软"><a href="#4-1-微软" class="headerlink" title="4.1 微软"></a>4.1 微软</h3><ul>
<li>仅支持office系列：doc,docx,ppt,pptx,xls,xlsx</li>
<li><a href="https://view.officeapps.live.com/op/view.aspx?src=[source]" target="_blank" rel="noopener">https://view.officeapps.live.com/op/view.aspx?src=[source]</a></li>
<li>source填上可直接访问的直链地址<h3 id="4-2-idocv"><a href="#4-2-idocv" class="headerlink" title="4.2 idocv"></a>4.2 idocv</h3></li>
<li>国产，支持类型多，收钱😂</li>
<li><a href="http://api.idocv.com/view/url?url=[source]" target="_blank" rel="noopener">http://api.idocv.com/view/url?url=[source]</a></li>
<li>source支持多种格式包括txt再也不乱码啦</li>
</ul>
<h2 id="5-h5页面心得"><a href="#5-h5页面心得" class="headerlink" title="5. h5页面心得"></a>5. h5页面心得</h2><h3 id="5-1-苹果iosh5页面-获取摇一摇权限和陀螺仪参数"><a href="#5-1-苹果iosh5页面-获取摇一摇权限和陀螺仪参数" class="headerlink" title="5.1 苹果iosh5页面 获取摇一摇权限和陀螺仪参数"></a>5.1 苹果iosh5页面 获取摇一摇权限和陀螺仪参数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">if</span> (location.protocol != <span class="string">'https:'</span>) &#123;</span><br><span class="line">   location.href = <span class="string">'https:'</span> + <span class="built_in">window</span>.location.href.substring(<span class="built_in">window</span>.location.protocol.length);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">requestT</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span>(DeviceMotionEvent) !== <span class="string">'undefined'</span> &amp;&amp; <span class="keyword">typeof</span>(DeviceMotionEvent.requestPermission) === <span class="string">'function'</span>) &#123;</span><br><span class="line">          </span><br><span class="line">          DeviceMotionEvent.requestPermission()</span><br><span class="line">          .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">	alert(<span class="string">'Orientation tracking '</span>+ response);</span><br><span class="line">          </span><br><span class="line">            <span class="keyword">if</span> (response == <span class="string">'granted'</span>) &#123;</span><br><span class="line">              <span class="built_in">window</span>.addEventListener(<span class="string">'devicemotion'</span>, (e) =&gt; &#123;</span><br><span class="line">               <span class="built_in">document</span>.getElementById(<span class="string">'request'</span>).style.visibility=<span class="string">'hidden'</span>;</span><br><span class="line">              &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">      .catch(<span class="built_in">console</span>.error)</span><br><span class="line">      &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">          alert(<span class="string">'DeviceMotionEvent is not defined'</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'request'</span>).onclick = requestT;</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>跟我们之前用taro里登陆获取用户信息权限一样，这个基于safaris内核比较严格，也要<strong>点击</strong>一个按钮，申请获取权限，必须是点击，跟taro一样，你放在函数体顺下来执行都不行。<br><img src="/2020/03/26/Sharing-of-2020-s-Spring/%E8%8B%B9%E6%9E%9Ch5_1.png" alt="h5"><br><img src="/2020/03/26/Sharing-of-2020-s-Spring/%E8%8B%B9%E6%9E%9Ch5_2.png" alt="h5"><br><a href="https://developer.apple.com/documentation/safari_release_notes/safari_13_release_notes#3314664" target="_blank" rel="noopener">苹果开发者文档</a><br><a href="https://stackoverflow.com/questions/56514116/how-do-i-get-deviceorientationevent-and-devicemotionevent-to-work-on-safari" target="_blank" rel="noopener">stack overflow 问题解答 早看到就好了😭</a></p>
<h3 id="5-2-一顿操作-引入tinymce-傻呆呆"><a href="#5-2-一顿操作-引入tinymce-傻呆呆" class="headerlink" title="5.2 一顿操作 引入tinymce 傻呆呆"></a>5.2 一顿操作 引入tinymce 傻呆呆</h3><ol>
<li>react项目里面最好不要再index.html里面再引入 外部的js文件，因为有保护措施 会有错误 详情看这篇问题</li>
<li>要引入 tinymce 要好好引入 每用到一个东西就都要引入进来 一些内置的方法就不能直接用 必须引入必须的包</li>
<li>跨域请求：本地想跨域请求设置代理，记住打包时用全url。</li>
</ol>
<h3 id="5-3-基于react的h5页面-与-安卓交互"><a href="#5-3-基于react的h5页面-与-安卓交互" class="headerlink" title="5.3 基于react的h5页面 与 安卓交互"></a>5.3 基于react的h5页面 与 安卓交互</h3><p>js与android交互<br>总体方法：<a href="https://blog.csdn.net/cs15229216584/article/details/53321750" target="_blank" rel="noopener">https://blog.csdn.net/cs15229216584/article/details/53321750</a><br>有些小问题<br>1、安卓 远程调试 webview网页<br><a href="https://www.jianshu.com/p/82f1465a07c9" target="_blank" rel="noopener">https://www.jianshu.com/p/82f1465a07c9</a></p>
<p>2、getitem undefined<br><a href="https://blog.csdn.net/HongEnIT/article/details/53558808" target="_blank" rel="noopener">https://blog.csdn.net/HongEnIT/article/details/53558808</a></p>
<p>3、react框架 java调用js 的函数 不是简单的写一个函数给 java调用 需要 在componetndidMount里面暴露给 window<br><a href="https://segmentfault.com/q/1010000017558921" target="_blank" rel="noopener">https://segmentfault.com/q/1010000017558921</a></p>
<p>4、让webview加载的页面有 调用相册的权限 <a href="https://www.jianshu.com/p/aa589c05c307" target="_blank" rel="noopener">https://www.jianshu.com/p/aa589c05c307</a></p>
<p>5、跨域调用api 需要再服务器端开启调用权限<br><a href="https://www.jianshu.com/p/aa589c05c307" target="_blank" rel="noopener">https://www.jianshu.com/p/aa589c05c307</a><br>或者 安卓端开启跨域权限<br><a href="https://blog.csdn.net/yclfdn2004/article/details/51364660" target="_blank" rel="noopener">https://blog.csdn.net/yclfdn2004/article/details/51364660</a></p>
<p>6、传递相互调用字符串跑出来了unicode<br>java那边将unicode字符串转换成java的string类型：<br><a href="https://blog.csdn.net/JodenHe/article/details/77343197" target="_blank" rel="noopener">https://blog.csdn.net/JodenHe/article/details/77343197</a><br><a href="https://www.cnblogs.com/yingyujyf/p/6861462.html" target="_blank" rel="noopener">https://www.cnblogs.com/yingyujyf/p/6861462.html</a></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/19/LeetCode记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="望星的太阳花">
      <meta itemprop="description" content="You are my JavaSript in my HTML.">
      <meta itemprop="image" content="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1570163730249&di=dcd36b04d1066a90ddb1f132ae3a6bcc&imgtype=0&src=http%3A%2F%2Fhbimg.b0.upaiyun.com%2Ffe60497fd762440686b6d5702c2c9f19df71fb9911009-LVWEJj_fw658">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SYPeng">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/02/19/LeetCode记录/" class="post-title-link" itemprop="url">LeetCode记录</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-02-19 19:27:25" itemprop="dateCreated datePublished" datetime="2020-02-19T19:27:25+08:00">2020-02-19</time>
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/17/Git学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="望星的太阳花">
      <meta itemprop="description" content="You are my JavaSript in my HTML.">
      <meta itemprop="image" content="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1570163730249&di=dcd36b04d1066a90ddb1f132ae3a6bcc&imgtype=0&src=http%3A%2F%2Fhbimg.b0.upaiyun.com%2Ffe60497fd762440686b6d5702c2c9f19df71fb9911009-LVWEJj_fw658">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SYPeng">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/02/17/Git学习/" class="post-title-link" itemprop="url">Git学习</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-02-17 15:52:27" itemprop="dateCreated datePublished" datetime="2020-02-17T15:52:27+08:00">2020-02-17</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-02-18 18:18:49" itemprop="dateModified" datetime="2020-02-18T18:18:49+08:00">2020-02-18</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Daily/" itemprop="url" rel="index"><span itemprop="name">Daily</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Git学习"><a href="#Git学习" class="headerlink" title="Git学习"></a>Git学习</h1><p>学习廖雪峰教程：<a href="https://www.liaoxuefeng.com/wiki/896043488029600" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/896043488029600</a></p>
<h2 id="Git简介"><a href="#Git简介" class="headerlink" title="Git简介"></a>Git简介</h2><ul>
<li>Git是目前世界上最先进的分布式版本控制系统（没有之一）。</li>
<li>这样，你就结束了手动管理多个“版本”的史前时代，进入到版本控制的20世纪。</li>
<li>Linus花了两周时间自己用C写了一个分布式版本控制系统，这就是Git！一个月之内，Linux系统的源码已经由Git管理了！<h3 id="集中式vs分布式"><a href="#集中式vs分布式" class="headerlink" title="集中式vs分布式"></a>集中式vs分布式</h3></li>
<li>Linus一直痛恨的CVS及SVN都是集中式的版本控制系统，而Git是分布式版本控制系统</li>
<li>集中式版本控制系统，版本库是集中存放在中央服务器的，而干活的时候，用的都是自己的电脑，所以要先从中央服务器取得最新的版本，然后开始干活，干完活了，再把自己的活推送给中央服务器。</li>
<li>分布式版本控制系统根本没有“中央服务器”，每个人的电脑上都是一个完整的版本库，这样，你工作的时候，就不需要联网了，因为版本库就在你自己的电脑上。既然每个人电脑上都有一个完整的版本库</li>
<li>Git的优势不单是不必联网这么简单，后面我们还会看到Git极其强大的分支管理，把SVN等远远抛在了后面。<h2 id="创建版本库"><a href="#创建版本库" class="headerlink" title="创建版本库"></a>创建版本库</h2><h3 id="创建版本库-1"><a href="#创建版本库-1" class="headerlink" title="创建版本库"></a>创建版本库</h3><blockquote>
<p><strong>版本库</strong>又名仓库，英文名repository，特点是这个目录里面的所有文件都可以被Git管理起来，每个文件的修改、删除，Git都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻可以“还原”。<br>命令行操作是先创建一个目录，再进行git初始化</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir learngit</span><br><span class="line">cd learngit</span><br><span class="line">pwd</span><br><span class="line">git init</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>操作完成之后多了一个<code>.git</code>的隐藏文件，用来记录版本信息。<br><em>也可以在一个已有的项目创建Git仓库</em></p>
<h3 id="把文件添加到版本库"><a href="#把文件添加到版本库" class="headerlink" title="把文件添加到版本库"></a>把文件添加到版本库</h3><p>版本控制系统，其实只能跟踪文本文件的改动<br>|文件类型|版本控制|<br>|-|-|<br>|txt,html，代码|Git可告诉每次的改动|<br>|图片、视频这些二进制文件|虽然可Git管理，但是不能跟踪文件具体的变化，只能把二进制文件串联知道大小改变|<br>|微软的word|也是二进制文件，无法跟踪|<br><em>因为文本是有编码的，如果没有历史遗留问题，强烈建议使用标准的UTF-8编码，所有语言使用同一种编码，既没有冲突，又被所有平台所支持。</em><br><strong>两步命令</strong>提交仓库目录下的文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git add readme.txt</span><br><span class="line">git commit -m &quot;wrote a readme file&quot;</span><br><span class="line">//-m后面输入的是本次提交的说明</span><br><span class="line">[master (root-commit) 63f05d9] wrote a readme file</span><br><span class="line"> 1 file changed, 2 insertions(+)</span><br><span class="line"> create mode 100644 readme.txt</span><br><span class="line">//1个文件改变，2处增加</span><br></pre></td></tr></table></figure>

<p>分<strong>两步命令</strong>是因为commit一次可以提交很多文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add file1.txt</span><br><span class="line">git add file2.txt file3.txt</span><br><span class="line">git commit -m <span class="string">"add 3 files."</span></span><br></pre></td></tr></table></figure>

<h2 id="时光穿梭机"><a href="#时光穿梭机" class="headerlink" title="时光穿梭机"></a>时光穿梭机</h2><p>修改readme.txt.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git status // 查看仓库现在还咋u哪个台</span><br><span class="line">git diff //查看修改的地方</span><br></pre></td></tr></table></figure>

<h3 id="版本退回"><a href="#版本退回" class="headerlink" title="版本退回"></a>版本退回</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git log // 显示从最近到最远的提交日志</span><br><span class="line">git log --pretty=oneline  //嫌输出信息太多，可以试试加上--pretty=oneline参数</span><br><span class="line">1094adb7b9b3807259d8cb349e7df1d4d6477073 (HEAD -&gt; master) append GPL</span><br><span class="line">e475afc93c209a690c39c13a46716e8fa000c366 add distributed</span><br><span class="line">eaadf4e385e865d25c48e7ca9c8395c3f7dfaef0 wrote a readme file</span><br></pre></td></tr></table></figure>

<p>一大串类似1094adb…的是commit id（版本号），而是一个SHA1计算出来的一个非常大的数字，用十六进制表示，因为Git是分布式的版本控制系统，后面我们还要研究多人在同一个版本库里工作</p>
<p><strong>现在返回上一个版本：</strong></p>
<ul>
<li>需要版本号，HEAD表示当前版本，上一版本表示HEAD^，上上版本HEAD^^，上100个版本HEAD~100</li>
<li><code>git reset --hard HEAD^</code></li>
<li><code>--hard</code>参数之后讲</li>
</ul>
<p>现在成功返回上一个版本，但是先前版本没有了，可返回，前提终端没有关闭，记录了上次的版本号码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git reflog //打印之前的git指令</span><br><span class="line">0b859e2 HEAD@&#123;3&#125;: reset: moving to HEAD^</span><br><span class="line">5836da2 (HEAD -&gt; master) HEAD@&#123;4&#125;: commit: append GPL    //得出id5836da2</span><br><span class="line">0b859e2 HEAD@&#123;5&#125;: commit: add distributed</span><br><span class="line">63f05d9 HEAD@&#123;6&#125;: commit (initial): wrote a readme file</span><br><span class="line"></span><br><span class="line">git reset --hard 5836da2 //就返回成功</span><br></pre></td></tr></table></figure>

<h3 id="工作区和暂存区"><a href="#工作区和暂存区" class="headerlink" title="工作区和暂存区"></a>工作区和暂存区</h3><p>Git和其他版本控制系统如SVN的一个不同之处就是有暂存区的概念。</p>
<ul>
<li>工作区（Working Directory）<br>就是你在电脑里能看到的目录，比如我的learngit文件夹就是一个工作区</li>
<li>版本库（Repository）<br>工作区有一个隐藏目录.git，这个不算工作区，而是Git的版本库。</li>
<li>暂存区（称为stage或者index）</li>
<li>还有Git为我们自动创建的第一个分支master，以及指向master的一个指针叫HEAD。<img src="https://www.liaoxuefeng.com/files/attachments/919020037470528/0">

</li>
</ul>
<p>分支和HEAD的概念我们以后再讲。<br><strong>你可以简单理解为，需要提交的文件修改通通放到暂存区，然后，一次性提交暂存区的所有修改。</strong></p>
<h3 id="管理修改"><a href="#管理修改" class="headerlink" title="管理修改"></a>管理修改</h3><p><strong>Git比其他版本控制系统设计得优秀，因为Git跟踪并管理的是修改，而非文件。</strong><br>第一次修改 -&gt; git add -&gt; 第二次修改 -&gt; git commit<br>上述修改只会提交第一次修改，第二次不会提交</p>
<p>第一次修改 -&gt; git add -&gt; 第二次修改 -&gt; git add -&gt; git commit<br>这样合并两次修改才正确</p>
<h3 id="撤销修改"><a href="#撤销修改" class="headerlink" title="撤销修改"></a>撤销修改</h3><ul>
<li><p>场景1：当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令git checkout – file。</p>
<ul>
<li><p>一种是readme.txt自修改后还没有被放到暂存区，现在，撤销修改就回到和版本库一模一样的状态；</p>
</li>
<li><p>一种是readme.txt已经添加到暂存区后，又作了<strong>修改</strong>，现在，撤销修改就回到添加到暂存区后的状态。</p>
</li>
<li><p>总之，就是让这个文件回到最近一次git commit或git add时的状态。</p>
</li>
</ul>
</li>
<li><p>场景2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令git reset HEAD <file>，就回到了场景1，第二步按场景1操作。</file></p>
</li>
<li><p>场景3：已经提交了不合适的修改到版本库时，想要撤销本次提交，参考版本回退一节，不过前提是没有推送到远程库。</p>
</li>
</ul>
<h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><p>将工作区的一个文件删除了，如果已经上传到版本库可以用git操作，没有到版本库则不行。</p>
<ol>
<li>从版本库删除文件，<code>git rm</code> 和 <code>git commit</code></li>
<li>另一种从工作区删错了， <code>git checkout -- file</code>返回原状态，无论修改或删除都可以返回</li>
</ol>
<h2 id="远程仓库"><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h2><p>git是分布式的，完全可以一个人有几个版本库，也可以两个人有版本库，最好是Github托管的方法。<br>首先给Github账号配置ssh密钥，这样Github账号就有本地你的电脑的密钥，可以上传文件到远程Github仓库。以前配置过hexo，也是基于Github托管的。</p>
<h3 id="添加远程库"><a href="#添加远程库" class="headerlink" title="添加远程库"></a>添加远程库</h3><p>在Github上创建一个仓库后,origin是远程库的名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@github.com:Ekko306/learngit.git //本地与远程关联 </span><br><span class="line">git push -u origin master //将当前分支master推送到远程</span><br></pre></td></tr></table></figure>

<p>由于远程库是空的，我们第一次推送master分支时，加上了-u参数，Git不但会把本地的master分支内容推送的远程新的master分支，还会<strong>把本地的master分支和远程的master分支关联起来</strong>，在以后的推送或者拉取时就可以简化命令。<br>从现在起，只要本地作了提交，就可以通过命令：</p>
<p><code>$ git push origin master</code></p>
<p><a href="https://www.liaoxuefeng.com/wiki/896043488029600/898732864121440" target="_blank" rel="noopener">SSH警告</a></p>
<p>分布式版本系统的最大好处之一是在本地工作完全不需要考虑远程库的存在，也就是有没有联网都可以正常工作，而SVN在没有联网的时候是拒绝干活的！当有网络的时候，再把本地提交推送一下就完成了同步，真是太方便了！</p>
<h3 id="从远程库克隆"><a href="#从远程库克隆" class="headerlink" title="从远程库克隆"></a>从远程库克隆</h3><p>要克隆一个仓库，首先必须知道仓库的地址，然后使用git clone命令克隆。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:michaelliao/gitskills.git</span><br><span class="line">git clone https://github.com/michaelliao/gitskills.git</span><br></pre></td></tr></table></figure>

<p>Git支持多种协议，包括https，但通过ssh支持的原生git协议速度最快。</p>
<h2 id="分支管理"><a href="#分支管理" class="headerlink" title="分支管理"></a>分支管理</h2><p>分支在实际中有什么用呢？假设你准备开发一个新功能，但是需要两周才能完成，第一周你写了50%的代码，如果立刻提交，由于代码还没写完，不完整的代码库会导致别人不能干活了。如果等代码全部写完再一次提交，又存在丢失每天进度的巨大风险。</p>
<p>现在有了分支，就不用怕了。你创建了一个属于你自己的分支，别人看不到，还继续在原来的分支上正常工作，而你在自己的分支上干活，想提交就提交，直到开发完毕后，再一次性合并到原来的分支上，这样，既安全，又不影响别人工作。</p>
<p>哦哦：</p>
<ul>
<li>创建一个分支是可以从团队分离出来，只完成自己负责的，最后汇总到主干分支</li>
<li>而也可以多个人在同一个分支里进行工作（比如开发一个特定功能），这时候会有冲突，然后解决。</li>
</ul>
<h3 id="创建与合并分支"><a href="#创建与合并分支" class="headerlink" title="创建与合并分支"></a>创建与合并分支</h3><p>一开始的时候，master分支是一条线，Git用<strong>master指向最新的提交</strong>，再用<strong>HEAD指向master</strong>，就能<strong>确定当前分支</strong>，以及当前分支的提交点：<br>当我们创建新的分支，例如dev时，Git新建了一个指针叫dev，指向master相同的提交，再把<strong>HEAD指向dev</strong>，就<strong>表示当前分支在dev上</strong><br><a href="https://www.liaoxuefeng.com/wiki/896043488029600/900003767775424" target="_blank" rel="noopener">git管理分支高效原理</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b dev  //创建dev分支，然后切换到dev分支</span><br><span class="line">//相当于底下两条命令</span><br><span class="line">git branch dev  //加参数dev创建新分支dev 不加查看所有分支</span><br><span class="line">git checkout dev  //切换分支为dev</span><br><span class="line"></span><br><span class="line">//dev上修改readme.txt并提交</span><br><span class="line"></span><br><span class="line">//在分支dev提交后 并不会改变master分支内容 必须merge合并，并且 更新是在master分支上</span><br><span class="line">git checkout master //切换到master</span><br></pre></td></tr></table></figure>

<p>git merge命令用于合并指定分支到当前分支。合并后，再查看readme.txt的内容，就可以看到，和dev分支的最新提交是完全一样的。<br>（注意到上面的Fast-forward信息，Git告诉我们，这次合并是“快进模式”，也就是直接把master指向dev的当前提交，所以合并速度非常快。<br>当然，也不是每次合并都能Fast-forward，我们后面会讲其他方式的合并。）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//合并完成后删除分支</span><br><span class="line">git branch -d dev</span><br></pre></td></tr></table></figure>

<p>因为创建、合并和删除分支非常快，所以Git<strong>鼓励你使用分支完成某个任务，合并后再删掉分支</strong>，这和直接在master分支上工作效果是一样的，但<strong>过程更安全</strong>。</p>
<h3 id="创建与合并分支-1"><a href="#创建与合并分支-1" class="headerlink" title="创建与合并分支"></a>创建与合并分支</h3><p>当一个分支改了一个文件，master也有这个文件改动，会有冲突，要解决冲突。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">git merge feature1   //有冲突</span><br><span class="line">Auto-merging readme.txt</span><br><span class="line">CONFLICT (content): Merge conflict in readme.txt</span><br><span class="line">Automatic merge failed; fix conflicts and then commit the result. </span><br><span class="line">git status //告诉我们冲突的文件</span><br><span class="line">vim readme.txt //打开冲突文件修改</span><br><span class="line">git add readme.txt </span><br><span class="line">git commit -m &quot;conflict fixed&quot; //再提交修改</span><br><span class="line">git log --graph --pretty=oneline --abbrev-commit //可查看冲突解决情况</span><br><span class="line">git branch -d feature1 //最后，删除feature1分支</span><br></pre></td></tr></table></figure>

<h2 id="分支管理策略"><a href="#分支管理策略" class="headerlink" title="分支管理策略"></a>分支管理策略</h2><p>就是之前的merge是Fast forward模式，这种模式，删除分支后会丢失分支信息，改良不用fast模式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git merge --no-ff -m &quot;merge with no-ff&quot; dev //这样就会有1一次分支提交信息，避免这次分支信息丢失，然后版本回退可以找到</span><br><span class="line">git log --graph --pretty=oneline --abbrev-commit //查看信息</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/17/Git学习/merge.png" alt="merge"></p>
<p><strong>分支策略</strong><br>大体意思是master保持最稳定最新的，其他人在dev上合并<br><img src="https://www.liaoxuefeng.com/files/attachments/919023260793600/0"></p>
<h2 id="BUG分支"><a href="#BUG分支" class="headerlink" title="BUG分支"></a>BUG分支</h2><p>就是你做你的工作做到一般的时候接到另一个任务（或者BUG任务），你可以临时保存现在的工作状态，去解决另一个任务，然后回来，如果是BUG任务，则有方法把修好的BUG更新到原来一半存好的任务里面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">git stash //保存原来状态</span><br><span class="line">git checkout master //确定到master上修BUG，切换master分支</span><br><span class="line">//到issues-101上解决分支 并修改到master</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git checkout dev //回来</span><br><span class="line">git status //原来状态没有</span><br><span class="line">git stash list //查看有一个stash保存状态</span><br><span class="line"></span><br><span class="line">//有两种恢复方式</span><br><span class="line">git stash apply // 恢复后不删除 要用git stash drop删除</span><br><span class="line">git stash pop //恢复后也删除了 &lt;-用这个</span><br><span class="line">git stash list //发现没有了</span><br><span class="line">git stash apply stash@&#123;0&#125;  //你可以多次stash，恢复的时候，先用git stash list查看，然后恢复指定的stash，用命</span><br></pre></td></tr></table></figure>

<p>由于是在master上修好了bug，dev仍然有bug，可以用命令指定某一次修BUG的提交，只修改特定的部分。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4c805e2 fix bug 101  // 找到修好bug的提交</span><br><span class="line">git cherry-pick 4c805e2</span><br></pre></td></tr></table></figure>

<p><strong>注意指定特定的修改也会可能有冲突，解决即可</strong></p>
<h3 id="Feature分支"><a href="#Feature分支" class="headerlink" title="Feature分支"></a>Feature分支</h3><p>每新加一个新功能，新建立一个branch来合并，这个分支称为feature分支，如果中途不需要了，用新命令行删除没有合并的分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -D feature-vulan //删除没有用合并的分支</span><br></pre></td></tr></table></figure>

<h2 id="多人协作"><a href="#多人协作" class="headerlink" title="多人协作"></a>多人协作</h2><p>当你从远程仓库克隆时，实际上Git自动把本地的master分支和远程的master分支对应起来了，并且，远程仓库的默认名称是origin。</p>
<p>要查看远程库的信息，用<code>git remote</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git remote</span><br><span class="line">origin</span><br></pre></td></tr></table></figure>

<p>或者，用<code>git remote -v</code>显示更详细的信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git remote -v</span><br><span class="line">origin  git@github.com:michaelliao/learngit.git (fetch)</span><br><span class="line">origin  git@github.com:michaelliao/learngit.git (push)</span><br></pre></td></tr></table></figure>

<p>上面显示了可以抓取和推送的origin的地址。如果没有推送权限，就看不到push的地址。</p>
<p><strong>推送分支：（按自己需求推送分支）</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push origin master  //推送master</span><br><span class="line">git push origin dev     //推送dev</span><br></pre></td></tr></table></figure>

<p>分支推送约定：<br><img src="/2020/02/17/Git学习/push.png" alt="push"></p>
<p><strong>抓取分支：</strong><br>当一个新同事克隆仓库，默认只有master分支，想和你一起开发dev，就要手动抓取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:michaelliao/learngit.git</span><br><span class="line">git branch //只有master</span><br><span class="line">git checkout -b dev origin/dev //注意是origin就可以抓取远程分支</span><br></pre></td></tr></table></figure>

<p><strong>远程冲突</strong><br>小伙伴修改dev后，恰好你也在修改dev，自己push会有冲突，可以先pull获取最新的，在自己本地修改完冲突后再提交。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git pull //也可能遇到dev没有和远程origin/dev对应问题，解决：</span><br><span class="line">git branch --set-upstream-to=origin/dev dev</span><br><span class="line">//再解决完冲突提交</span><br></pre></td></tr></table></figure>

<p><strong>多人协作总结：</strong><br><img src="/2020/02/17/Git学习/cor.png" alt="cor"></p>
<h2 id="Rebase"><a href="#Rebase" class="headerlink" title="Rebase"></a>Rebase</h2><p>之前每次上传代码要push，如果有人先于你push了代码，你要先pull一下最新的，然后会有新的分支</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//先修改的：</span><br><span class="line">$ git log --graph --pretty=oneline --abbrev-commit</span><br><span class="line">* 582d922 (HEAD -&gt; master) add author  //增加2</span><br><span class="line">* 8875536 add comment  //增加1</span><br><span class="line">* d1be385 (origin/master) init hello    //基于init hello</span><br><span class="line"></span><br><span class="line">//git push 失败 进行git pull 看起来很乱</span><br><span class="line">*   e0ea545 (HEAD -&gt; master) Merge branch &apos;master&apos; of github.com:michaelliao/learngit //本地</span><br><span class="line">|\  </span><br><span class="line">| * f005ed4 (origin/master) set exit=1   //git pull获取的 这里就变成了 远程 origin/master</span><br><span class="line">* | 582d922 add author</span><br><span class="line">* | 8875536 add comment</span><br><span class="line">|/  </span><br><span class="line">* d1be385 init hello </span><br><span class="line"></span><br><span class="line">//使用git rebase 重新构建</span><br><span class="line">* 7e61ed4 (HEAD -&gt; master) add author</span><br><span class="line">* 3611cfe add comment</span><br><span class="line">* f005ed4 (origin/master) set exit=1   //发现远程挪到了后面 又新添加了提交 add author add comment，基于set exit=1 不再基于init hello</span><br><span class="line">* d1be385 init hello</span><br></pre></td></tr></table></figure>

<h2 id="标签管理"><a href="#标签管理" class="headerlink" title="标签管理"></a>标签管理</h2><p>标签是一个版本库的快照，想要取哪一个版本取出打了标签的commit</p>
<h3 id="创建标签"><a href="#创建标签" class="headerlink" title="创建标签"></a>创建标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">git tag v1.0 //默认打在最新提交的commit上</span><br><span class="line"></span><br><span class="line">git log --pretty=oneline --abbrev-commit  </span><br><span class="line">git tag v0.9 de8887c //打在指定的历史commit上</span><br><span class="line"></span><br><span class="line">git show v0.9  //现实标签信息</span><br><span class="line"></span><br><span class="line">git tag -a v0.1 -m &quot;version 0.1 released&quot; e8caf37 //创建带有说明的标签 -a指定标签名 -m指定说明文字</span><br><span class="line"></span><br><span class="line">git show v0.1 //查看说明文字</span><br></pre></td></tr></table></figure>

<p><strong>注意:</strong>标签总是和某个commit挂钩。如果这个commit既出现在master分支，又出现在dev分支，那么在这两个分支上都可以看到这个标签。</p>
<h3 id="操作标签"><a href="#操作标签" class="headerlink" title="操作标签"></a>操作标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git tag -d v0.1 //删除标签</span><br><span class="line"></span><br><span class="line">//由于标签都是在本地的 可以把标签推送到远程</span><br><span class="line">git push origin v1.0 //推送v1.0一个标签</span><br><span class="line">git push origin --tags //推送所有标签</span><br><span class="line"></span><br><span class="line">//删除麻烦一点</span><br><span class="line">git tag -d v0.9  //本地删除</span><br><span class="line">git push origin :refs/tags/v0.9 //删除远程标签</span><br></pre></td></tr></table></figure>

<h2 id="使用GitHub"><a href="#使用GitHub" class="headerlink" title="使用GitHub"></a>使用GitHub</h2><p>使用GitHub可以很方便的参与开源项目修改</p>
<ol>
<li>fork别人的仓库称自己的</li>
<li>本地git clone 克隆自己仓库的修改，自己的仓库可以修改，不能改别人的 因为没有权限</li>
<li>自己改完后申请一个pull request</li>
</ol>
<h2 id="使用Gitee"><a href="#使用Gitee" class="headerlink" title="使用Gitee"></a>使用Gitee</h2><p>可以使用国内的代码托管平台，内容和GitHub差不多</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">git remote -v //查看关联版本</span><br><span class="line"></span><br><span class="line">git remote rm origin //删除之前关联github</span><br><span class="line"></span><br><span class="line">git remote add origin git@gitee.com:liaoxuefeng/learngit.git //与gitee关联</span><br><span class="line"></span><br><span class="line">//可以同时关联github和gitee，要起不一样的名字，现在是origin</span><br><span class="line">git remote add github git@github.com:michaelliao/learngit.git  //github</span><br><span class="line">git remote add gitee git@gitee.com:liaoxuefeng/learngit.git  //gitee</span><br><span class="line"></span><br><span class="line">git push github master //推到github</span><br><span class="line">git push gitee master //推到gitee</span><br></pre></td></tr></table></figure>

<h2 id="自定义Git"><a href="#自定义Git" class="headerlink" title="自定义Git"></a>自定义Git</h2><p><code>git config --global color.ui true</code>配置Git显示颜色</p>
<h3 id="忽略特殊文件"><a href="#忽略特殊文件" class="headerlink" title="忽略特殊文件"></a>忽略特殊文件</h3><p>这个很重要，有些本地生成的或者依赖文件不需要上传就卸载gitinore里面，GitHub整合各种配置文件<br><a href="https://github.com/github/gitignore" target="_blank" rel="noopener">https://github.com/github/gitignore</a></p>
<p>忽略文件的原则是：</p>
<ul>
<li>忽略操作系统自动生成的文件，比如缩略图等；</li>
<li>忽略编译生成的中间文件、可执行文件等，也就是如果一个文件是通过另一个文件自动生成的，那自动生成的文件就没必要放进版本库，比如Java编译产生的.class文件；</li>
<li>忽略你自己的带有敏感信息的配置文件，比如存放口令的配置文件。</li>
</ul>
<p>比如配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># Windows:</span><br><span class="line">Thumbs.db</span><br><span class="line">ehthumbs.db</span><br><span class="line">Desktop.ini</span><br><span class="line"></span><br><span class="line"># Python:</span><br><span class="line">*.py[cod]</span><br><span class="line">*.so</span><br><span class="line">*.egg</span><br><span class="line">*.egg-info</span><br><span class="line">dist</span><br><span class="line">build</span><br><span class="line"></span><br><span class="line"># My configurations:</span><br><span class="line">db.ini</span><br><span class="line">deploy_key_rsa</span><br></pre></td></tr></table></figure>

<p>然后把.gitignore提交到Git就完成了<br>如果被忽略了会发现git add失败，强制添加：<br><code>git add -f App.class</code><br>或者自动检查，告诉哪一行忽略文件忽略了文件<br><code>git check-ignore -v App.class</code></p>
<h3 id="设置别名"><a href="#设置别名" class="headerlink" title="设置别名"></a>设置别名</h3><p>可以将复杂长的命令配置别名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">git config --global alias.st status //将git status 变成 git st</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ git config --global alias.co checkout</span><br><span class="line">$ git config --global alias.ci commit</span><br><span class="line">$ git config --global alias.br branch</span><br><span class="line"></span><br><span class="line">//长一点的 git reset HEAD file</span><br><span class="line">git config --global alias.unstage &apos;reset HEAD&apos;</span><br><span class="line">//就可以使用替代</span><br><span class="line">git unstage test.py</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git config --global alias.last &apos;log -1&apos; //显示最后一次提交</span><br><span class="line">git config --global alias.lg &quot;log --color --graph --pretty=format:&apos;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&apos; --abbrev-commit&quot; //更丰富的提交信息</span><br></pre></td></tr></table></figure>

<p><strong>配置文件</strong><br>加上–global 针对所有仓库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat .git/config  //查看仓库的Git配置文件</span><br><span class="line"></span><br><span class="line">cat .gitconfig   //查看当前用户的配置文件 根目录下，配错了快捷键可以改</span><br></pre></td></tr></table></figure>

<h3 id="搭建Git服务器"><a href="#搭建Git服务器" class="headerlink" title="搭建Git服务器"></a>搭建Git服务器</h3><p>自家看：<a href="https://www.liaoxuefeng.com/wiki/896043488029600/899998870925664#0" target="_blank" rel="noopener">https://www.liaoxuefeng.com/wiki/896043488029600/899998870925664#0</a></p>
<h2 id="使用SourceTree"><a href="#使用SourceTree" class="headerlink" title="使用SourceTree"></a>使用SourceTree</h2><p>图形化git管理应用，也可以用Github Desktop</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/02/12/Training-Yolov3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="望星的太阳花">
      <meta itemprop="description" content="You are my JavaSript in my HTML.">
      <meta itemprop="image" content="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1570163730249&di=dcd36b04d1066a90ddb1f132ae3a6bcc&imgtype=0&src=http%3A%2F%2Fhbimg.b0.upaiyun.com%2Ffe60497fd762440686b6d5702c2c9f19df71fb9911009-LVWEJj_fw658">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SYPeng">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/02/12/Training-Yolov3/" class="post-title-link" itemprop="url">Training Yolov3</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2020-02-12 09:30:41 / 修改时间：21:09:40" itemprop="dateCreated datePublished" datetime="2020-02-12T09:30:41+08:00">2020-02-12</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Deep-Learning/" itemprop="url" rel="index"><span itemprop="name">Deep-Learning</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="训练Yolov3（深度学习流程）"><a href="#训练Yolov3（深度学习流程）" class="headerlink" title="训练Yolov3（深度学习流程）"></a>训练Yolov3（深度学习流程）</h1><blockquote>
<p><strong>总结</strong>整个深度学习的流程，数据集-&gt;模型训练-&gt;部署模型。</p>
</blockquote>
<h2 id="数据集"><a href="#数据集" class="headerlink" title="数据集"></a>数据集</h2><p>想训练自己的数据集就必须学会如何标注样本做目标检测。</p>
<h3 id="不同格式的数据集总结"><a href="#不同格式的数据集总结" class="headerlink" title="不同格式的数据集总结"></a>不同格式的数据集总结</h3><p>数据集常用格式：</p>
<ul>
<li>PASCAL VOC</li>
<li>COCO</li>
<li>YOLO</li>
</ul>
<h4 id="PASCAL-VOC"><a href="#PASCAL-VOC" class="headerlink" title="PASCAL VOC"></a>PASCAL VOC</h4><blockquote>
<p>voc数据集是由PASCAL VOC竞赛发起。PASCAL VOC竞赛目标主要是目标识别，其提供的数据集里包含了20类的物体。使用xml文件标注。</p>
</blockquote>
<p>详解：<a href="https://blog.csdn.net/pxh_ww/article/details/98961168" target="_blank" rel="noopener">https://blog.csdn.net/pxh_ww/article/details/98961168</a></p>
<h4 id="COCO"><a href="#COCO" class="headerlink" title="COCO"></a>COCO</h4><blockquote>
<p>COCO数据集是一个大型的、丰富的物体检测，分割和字幕数据集。这个数据集以scene understanding为目标，主要从复杂的日常场景中截取，图像中的目标通过精确的segmentation进行位置的标定。使用json文件标注。</p>
</blockquote>
<p>详解：<a href="https://blog.csdn.net/fireflychh/article/details/83040205" target="_blank" rel="noopener">https://blog.csdn.net/fireflychh/article/details/83040205</a></p>
<h4 id="YOLO"><a href="#YOLO" class="headerlink" title="YOLO"></a>YOLO</h4><blockquote>
<p>YOLO格式用于YOLO模型的检测。使用txt文件标注。</p>
</blockquote>
<img src="/2020/02/12/Training-Yolov3/yolo.png" width="400" height="250" alt="图片名称" align="center">

<h3 id="使用labelImage标注"><a href="#使用labelImage标注" class="headerlink" title="使用labelImage标注"></a>使用labelImage标注</h3><p>使用标注工具标注自己的图片，应用也很简单，下载github代码运行后，一看就会用。支持导出PASCAL VOC和YOLO两种格式<br><img src="/2020/02/12/Training-Yolov3/labelimg.png" width="700" height="350" alt="图片名称" align="center"><br>（为方便，可先定义根目录下data文件的predefined_classes.txt）</p>
<hr>
<p>若格式需求不同也可以用整理好的datasets工具：<br><img src="/2020/02/12/Training-Yolov3/datasets.png" width="800" height="350" alt="图片名称" align="center"><br>主要是使用每个工具配置一下文件路径，比如配置voc_to_yolo_cfg.py<br>同时还有啥样本分割的工具在utils目录下。<br>最后按照不同框架需求的数据集使用就可以训练数据集了。（以下yolo例子）<br><a href="https://github.com/pjreddie/darknet" target="_blank" rel="noopener">https://github.com/pjreddie/darknet</a></p>
<h2 id="模型训练"><a href="#模型训练" class="headerlink" title="模型训练"></a>模型训练</h2><p>本来要学习mmdetection工具箱，但是折腾很久发现不支持cpu，安装必须要求有cuda(gpu)，就转而学习yolov3的训练，yolov3支持cpu和gpu两种，原理有相似处，不过这里总结yolov3的配置方法与训练方法。<br>（还有之前老师视频是ultralytics/yolov3，但是版本更新了，之前录的视频跑出来报错也不知道为啥，就改成了darknet的yolov3，视频的数据集啊差不多也能跑）</p>
<h3 id="配置数据集"><a href="#配置数据集" class="headerlink" title="配置数据集"></a>配置数据集</h3><p>按照视频来，很详细，一看文件就会：<br>放在根路径下：<br><img src="/2020/02/12/Training-Yolov3/data.png" alt="data"></p>
<h3 id="配置config"><a href="#配置config" class="headerlink" title="配置config"></a>配置config</h3><h4 id="yolov3-cfg"><a href="#yolov3-cfg" class="headerlink" title="yolov3.cfg"></a>yolov3.cfg</h4><p>定义yolov3的一些模型参数，有些参数需要调整比如classes=6.filters=33啥的视频很详细。<br><img src="/2020/02/12/Training-Yolov3/cfg.png" alt="cfg"></p>
<h4 id="cards-data"><a href="#cards-data" class="headerlink" title="cards.data"></a>cards.data</h4><p>定义所有自定义内容的路径<br><img src="/2020/02/12/Training-Yolov3/cards_data.png" alt="data"></p>
<h3 id="下载预训练模型参数"><a href="#下载预训练模型参数" class="headerlink" title="下载预训练模型参数"></a>下载预训练模型参数</h3><p>我们这里下载<code>darknet53.conv.74</code>放到根目录下，之后根据预先训练模型进行一些参数调整就会比较快</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://pjreddie.com/media/files/darknet53.conv<span class="number">.74</span></span><br></pre></td></tr></table></figure>

<h3 id="训练模型"><a href="#训练模型" class="headerlink" title="训练模型"></a>训练模型</h3><p>上诉三个步骤完成之后，就可以运行代码开始训练</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./darknet detector train cfg/cards.data  cfg/yolov3.cfg  darknet53.conv<span class="number">.74</span></span><br></pre></td></tr></table></figure>

<p><strong>执行上述命令就会开始训练的，但是我的电脑太慢😂，16张图片训练要花5-10分钟，昨天训练几个小时只训练了20个batch😂，同时darknet的输出打印信息也需要读懂：</strong><br><img src="/2020/02/12/Training-Yolov3/log.png" alt="log"><br><strong>昨天训练很久 损失很大 iou很小 class契合度也不高，不知道什么地方有问题，由于模型训练太慢，看了代码训练100个batch才会在backup里保存一次权重，也不知道咋改。</strong><br>如果之后在集群上改 可以快点跑出结果然后学习如何调参数</p>
<h3 id="测试模型"><a href="#测试模型" class="headerlink" title="测试模型"></a>测试模型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./darknet detect cfg/yolov3.cfg yolov3.weights data/doa.jpg</span><br></pre></td></tr></table></figure>

<p>训练好模型之后就可以使用类似上述的命令对一张图片进行目标检测，若训练好的权重可以比较好的识别图片就可以尽心下一步，将模型部署到我们的机器上面进行汽车计数（上述是yolov3的权重比较好的识别物体）<br><img src="/2020/02/12/Training-Yolov3/predictions.jpg" alt="log"></p>
<h3 id="mmdetection"><a href="#mmdetection" class="headerlink" title="mmdetection"></a>mmdetection</h3><p>网上学了一些mmdetection的博文，它现在支持voc和coco数据集格式，原理差不多，看着操作应该不难，关键是自己电脑不能安装mmdetection不能实践。<br><a href="https://blog.csdn.net/qq_36302589/article/details/86149293" target="_blank" rel="noopener">https://blog.csdn.net/qq_36302589/article/details/86149293</a><br>比较类似的命令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python tools/train.py &lt;CONFIG_FILE&gt; --gpus &lt;GPU_NUM&gt; --work_dir &lt;WORK_DIR&gt;</span><br><span class="line">python tools/test.py configs/cascade_rcnn_r101_fpn_1x.py ../work_dirs/cascade_rcnn_r101_fpn_1x/epoch_16.pth --gpus <span class="number">4</span> --out ./result/result_16.pkl --eval bbox --show</span><br></pre></td></tr></table></figure>

<p>流程大体是：<br><strong>放好数据集-&gt;配置配置文件-&gt;命令行开始训练</strong><br>光会使用可能还不够，还需要学习内部代码是如何实现的，比如看了yolov3发现python的代码里面还有c语言代码，一些batch啥的仔细看</p>
<h2 id="部署模型"><a href="#部署模型" class="headerlink" title="部署模型"></a>部署模型</h2><p>将训练好的模型 使用opencv实现，<br>在网上找到一个使用yolov2权重的例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">cap = cv2.VideoCapture(<span class="string">'solidYellowLeft.mp4'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_cfg_model</span><span class="params">()</span>:</span></span><br><span class="line">    model_path = <span class="string">'/Users/suyapeng/Desktop/darknet/cfg/yolov2.weights'</span></span><br><span class="line">    cfg_path = <span class="string">'/Users/suyapeng/Desktop/darknet/cfg/yolov2.cfg'</span></span><br><span class="line">    yolo_net = cv2.dnn.readNet(model_path, cfg_path, <span class="string">'darknet'</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        flag, img = cap.read()</span><br><span class="line">        <span class="keyword">if</span> flag:</span><br><span class="line">            rows = img.shape[<span class="number">0</span>]</span><br><span class="line">            cols = img.shape[<span class="number">1</span>]</span><br><span class="line">            yolo_net.setInput(cv2.dnn.blobFromImage(img, <span class="number">1.0</span>/<span class="number">127.5</span>, (<span class="number">416</span>, <span class="number">416</span>), (<span class="number">127.5</span>, <span class="number">127.5</span>, <span class="number">127.5</span>), <span class="literal">False</span>, <span class="literal">False</span>))</span><br><span class="line">            cvOut = yolo_net.forward()</span><br><span class="line">            <span class="keyword">for</span> detection <span class="keyword">in</span> cvOut:</span><br><span class="line">                confidence = np.max(detection[<span class="number">5</span>:])</span><br><span class="line">                <span class="keyword">if</span> confidence &gt; <span class="number">0</span>:</span><br><span class="line">                    classIndex = np.argwhere(detection == confidence)[<span class="number">0</span>][<span class="number">0</span>] - <span class="number">5</span></span><br><span class="line">                    x_center = detection[<span class="number">0</span>] * cols</span><br><span class="line">                    y_center = detection[<span class="number">1</span>] * rows</span><br><span class="line">                    width = detection[<span class="number">2</span>] * cols</span><br><span class="line">                    height = detection[<span class="number">3</span>] * rows</span><br><span class="line">                    start = (int(x_center - width/<span class="number">2</span>), int(y_center - height/<span class="number">2</span>))</span><br><span class="line">                    end = (int(x_center + width/<span class="number">2</span>), int(y_center + height/<span class="number">2</span>))</span><br><span class="line">                    cv2.rectangle(img,start, end , (<span class="number">23</span>, <span class="number">230</span>, <span class="number">210</span>), thickness=<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        cv2.imshow(<span class="string">'show'</span>, img)</span><br><span class="line">        cv2.waitKey(<span class="number">10</span>)</span><br><span class="line">        </span><br><span class="line">read_cfg_model()</span><br></pre></td></tr></table></figure>

<p>运行了一下，是可以实现的，只不过这个例子效果比较差，到时候可以尽量训练好我们的模型。<br><strong>主要是opencv的加载深度学习模型的api:cv2.dnn.readNet</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yolo_net = cv2.dnn.readNet(model_path, cfg_path, <span class="string">'darknet'</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2020/02/12/Training-Yolov3/png.png" alt="png"><br>现在官网更新了api，支持多种深度学习框架：<br><img src="/2020/02/12/Training-Yolov3/dnn.png" alt="png"></p>
<p><strong>次要是调取videoCapture()获取摄像头帧并进行检测</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cv2.VideoCapture(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p><strong>大体就能完成目标检测的流程，当然还有很多细节需要去实践处理，到时候有了gpu集群训练快一点再来修改超参数学习也许理解应用更深刻，现在在理论上串联起来（实践使用mmdetection，现在是yolo）。</strong></p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

    
  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1570163730249&di=dcd36b04d1066a90ddb1f132ae3a6bcc&imgtype=0&src=http%3A%2F%2Fhbimg.b0.upaiyun.com%2Ffe60497fd762440686b6d5702c2c9f19df71fb9911009-LVWEJj_fw658"
      alt="望星的太阳花">
  <p class="site-author-name" itemprop="name">望星的太阳花</p>
  <div class="site-description" itemprop="description">You are my JavaSript in my HTML.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/yourname" title="GitHub &rarr; https://github.com/yourname" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="mailto:1186179435@qq.com" title="E-Mail &rarr; mailto:1186179435@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">望星的太阳花</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.4.1</div>

        












        
      </div>
    </footer>
  </div>

  
    
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.1"></script><script src="/js/motion.js?v=7.4.1"></script>
<script src="/js/schemes/muse.js?v=7.4.1"></script>

<script src="/js/next-boot.js?v=7.4.1"></script>



  





















  

  

  

</body>
</html>
